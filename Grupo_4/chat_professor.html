<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8">
    <title>Chat com Professor</title>
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <header class="cabecalho">
      <a href="index.html" class="cabecalho__icone">
        <img src="img/casa.png" alt="Início">
      </a>
      <h1 class="cabecalho__titulo">Teach Me!</h1>
      <a href="tela_perfil.html" class="cabecalho__icone">
        <img src="img/pessoa.png" alt="Perfil">
      </a>
    </header>

    <main class="conteudo-principal">
      <div class="cabecalho-chat">
        <div class="info-professor-chat">
          <div class="foto-professora-chat">
            <img src="img/ana.png" alt="Foto da Prof. Ana Souza">
          </div>
          <div class="dados-professor-chat">
            <h1 class="titulo-secao">Prof. Ana Souza</h1>
            <p class="status-professor">Matemática • Online</p>
          </div>
        </div>
        
        <nav class="navegacao-principal">
          <a href="#" id="botao-voltar" class="botao botao-secundario">← Voltar</a>
        </nav>
      </div>

      <div class="container-chat">
        <div class="area-mensagens" id="area-mensagens">
          <div class="mensagem-professor">
            <div class="avatar-professor">
              <img src="img/ana.png" alt="Prof. Ana">
            </div>
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-professor">Prof. Ana Souza</span>
                <span class="hora-mensagem">14:30</span>
              </div>
              <div class="texto-mensagem">
                Olá! Como posso ajudá-lo hoje? Tem alguma dúvida sobre matemática?
              </div>
            </div>
          </div>

          <div class="mensagem-aluno">
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-aluno">Você</span>
                <span class="hora-mensagem">14:32</span>
              </div>
              <div class="texto-mensagem">
                Oi professora! Tenho uma dúvida sobre equações do segundo grau.
              </div>
            </div>
            <div class="avatar-aluno">
              <img src="img/pessoa.png" alt="Aluno">
            </div>
          </div>

          <div class="mensagem-professor">
            <div class="avatar-professor">
              <img src="img/ana.png" alt="Prof. Ana">
            </div>
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-professor">Prof. Ana Souza</span>
                <span class="hora-mensagem">14:33</span>
              </div>
              <div class="texto-mensagem">
                Perfeito! Equações do segundo grau são fundamentais. Qual é sua dúvida específica?
              </div>
            </div>
          </div>

          <div class="mensagem-aluno">
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-aluno">Você</span>
                <span class="hora-mensagem">14:35</span>
              </div>
              <div class="texto-mensagem">
                Não estou conseguindo resolver x² - 5x + 6 = 0
              </div>
            </div>
            <div class="avatar-aluno">
              <img src="img/pessoa.png" alt="Aluno">
            </div>
          </div>

          <div class="mensagem-professor">
            <div class="avatar-professor">
              <img src="img/ana.png" alt="Prof. Ana">
            </div>
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-professor">Prof. Ana Souza</span>
                <span class="hora-mensagem">14:36</span>
              </div>
              <div class="texto-mensagem">
                Vamos resolver juntos! Primeiro, vamos usar a fórmula de Bhaskara:
                <br><br>
                Δ = b² - 4ac
                <br>
                Δ = (-5)² - 4(1)(6)
                <br>
                Δ = 25 - 24 = 1
                <br><br>
                x = (5 ± √1) / 2
                <br>
                x₁ = (5 + 1) / 2 = 3
                <br>
                x₂ = (5 - 1) / 2 = 2
                <br><br>
                As raízes são x = 2 e x = 3. Conseguiu entender?
              </div>
            </div>
          </div>
        </div>

        <div class="area-envio">
          <form class="formulario-envio" id="formulario-envio">
            <div class="container-input">
              <input type="text" id="input-mensagem" class="input-mensagem" placeholder="Digite sua mensagem..." required>
              <button type="submit" class="botao-enviar">Enviar</button>
            </div>
          </form>
        </div>
      </div>
    </main>

    <footer class="rodape">
      <nav class="navegacao-rodape">
        <a href="configuracoes.html" class="link-rodape">Configurações</a>
        <a href="calendario.html" class="link-rodape">Agenda</a>
        <a href="progresso.html" class="link-rodape">Progresso</a>
        <a href="mensagens.html" class="link-rodape">Mensagens</a>
      </nav>
    </footer>

    <script>
      // Função para voltar à página anterior
      document.getElementById('botao-voltar').addEventListener('click', function(e) {
        e.preventDefault();
        
        // Obter parâmetros da URL
        const urlParams = new URLSearchParams(window.location.search);
        const paginaVoltar = urlParams.get('voltar');
        
        if (paginaVoltar) {
          window.location.href = paginaVoltar + '.html';
        } else {
          // Fallback para página anterior no histórico
          window.history.back();
        }
      });

      // Função para enviar mensagem
      document.getElementById('formulario-envio').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const input = document.getElementById('input-mensagem');
        const mensagem = input.value.trim();
        
        if (mensagem) {
          adicionarMensagemAluno(mensagem);
          input.value = '';
          
          // Simular resposta do professor após 2 segundos
          setTimeout(() => {
            adicionarMensagemProfessor("Entendi sua mensagem! Vou responder em breve.");
          }, 2000);
        }
      });

      function adicionarMensagemAluno(texto) {
        const areaMensagens = document.getElementById('area-mensagens');
        const agora = new Date();
        const hora = agora.getHours().toString().padStart(2, '0') + ':' + agora.getMinutes().toString().padStart(2, '0');
        
        const mensagemHTML = `
          <div class="mensagem-aluno">
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-aluno">Você</span>
                <span class="hora-mensagem">${hora}</span>
              </div>
              <div class="texto-mensagem">${texto}</div>
            </div>
            <div class="avatar-aluno">
              <img src="img/pessoa.png" alt="Aluno">
            </div>
          </div>
        `;
        
        areaMensagens.insertAdjacentHTML('beforeend', mensagemHTML);
        areaMensagens.scrollTop = areaMensagens.scrollHeight;
      }

      function adicionarMensagemProfessor(texto) {
        const areaMensagens = document.getElementById('area-mensagens');
        const agora = new Date();
        const hora = agora.getHours().toString().padStart(2, '0') + ':' + agora.getMinutes().toString().padStart(2, '0');
        
        const mensagemHTML = `
          <div class="mensagem-professor">
            <div class="avatar-professor">
              <img src="img/ana.png" alt="Prof. Ana">
            </div>
            <div class="conteudo-mensagem">
              <div class="cabecalho-mensagem">
                <span class="nome-professor">Prof. Ana Souza</span>
                <span class="hora-mensagem">${hora}</span>
              </div>
              <div class="texto-mensagem">${texto}</div>
            </div>
          </div>
        `;
        
        areaMensagens.insertAdjacentHTML('beforeend', mensagemHTML);
        areaMensagens.scrollTop = areaMensagens.scrollHeight;
      }

      // Scroll automático para a última mensagem ao carregar a página
      window.addEventListener('load', function() {
        const areaMensagens = document.getElementById('area-mensagens');
        areaMensagens.scrollTop = areaMensagens.scrollHeight;
      });
    </script>
  </body>
</html>
